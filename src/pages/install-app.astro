---
import Layout from "../layouts/Layout.astro";
import "../styles/critical.css";
import "../styles/global.css";
import "../styles/base.css";
---

<script>
  function updateGuide() {
    const ua = navigator.userAgent;
    // This is used to differentiate iPads from Macbooks
    const hasTouch = navigator.maxTouchPoints >= 1;
    // UA for iPads and Macs contain "Macintosh"
    const isMacIdentity = ua.includes("Macintosh");

    console.log("User Agent:", ua);
    console.log("Has Touch:", navigator.maxTouchPoints);

    const isIOSMobile = /iPhone|iPod/.test(ua);
    const isiPad = isMacIdentity && hasTouch;
    const isAndroid = /Android/.test(ua);

    const iosSection = document.getElementById("ios-guide");
    const androidSection = document.getElementById("android-guide");
    const desktopSection = document.getElementById("desktop-guide");

    if (isIOSMobile || isiPad) {
      iosSection?.classList.remove("hidden");
      androidSection?.classList.add("hidden");
      desktopSection?.classList.add("hidden");
    } else if (isAndroid) {
      androidSection?.classList.remove("hidden");
      desktopSection?.classList.add("hidden");
    } else {
      desktopSection?.classList.remove("hidden");
    }
  }

  // Ensure the DOM is fully loaded before running the script
  document.addEventListener("DOMContentLoaded", updateGuide);
</script>

<Layout title="How to Install This App">
  <section class="install-guide">
    <h2>How to Install This App</h2>

    <section id="ios-guide" class="guide-section hidden">
      <h3>iPhone & iPad (Safari)</h3>
      <ol>
        <li>Open Safari and go to our website.</li>
        <li>
          Tap the <strong>Share</strong> icon (the square with an arrow pointing up).
        </li>
        <li>
          Scroll down (or tap "More") and tap <strong
            >"Add to Home Screen."</strong>
        </li>
      </ol>
      <img
        src="/assets/images/install/ios.png"
        alt="iOS Safari Share menu"
      />
    </section>

    <section id="android-guide" class="guide-section hidden">
      <h3>Android (Chrome)</h3>
      <ol>
        <li>Tap the <strong>three dots</strong> in the top-right corner.</li>
        <li>Tap <strong>"Install app"</strong> or "Add to Home screen."</li>
      </ol>
      <img src="/assets/images/install/android.png" alt="Android Chrome menu" />
    </section>

    <section id="desktop-guide" class="guide-section">
      <h3>Computers (Chrome/Edge)</h3>
      <p>You can install this app on your computer for quick access.</p>
      <ol>
        <li>Look at the address bar at the top of your browser.</li>
        <li>
          Click the <strong>Install</strong> icon (usually a computer screen with
          an arrow).
        </li>
        <li>Follow the prompt to install.</li>
      </ol>
      <img
        src="/assets/images/install/desktop.png"
        alt="Chrome desktop PWA install icon"
      />
    </section>
  </section>

  <style>
    .install-guide {
      margin: 1rem 0;
      padding: 1rem;
      padding-top: 4.5rem;
      text-align: center;
    }

    .guide-section {
      margin: 1.5rem 0;
      padding: 1rem;
      background: var(--vt-c-white-soft);
      border: 1px solid var(--vt-c-divider-light-1);
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .guide-section h3 {
      font-size: 1.2em;
      margin-bottom: 0.5rem;
      color: var(--vt-c-black);
    }

    .guide-section ol {
      padding-left: 1.5rem;
      text-align: left;
      color: var(--vt-c-black-soft);
    }

    .guide-section li {
      margin-bottom: 0.75rem;
    }

    .guide-section img {
      max-width: 100%;
      height: auto;
      margin-top: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .hidden {
      display: none;
    }
  </style>
</Layout>
